description: >
  Represents a physical mailing, billing, or operational address. 
  Supports both structured references to Country/Locality and free-text fields for flexibility.
allOf:
  - $ref: "../index.yaml#/components/schemas/cEntity"
  - type: object
    properties:
      addressLines:
        type: array
        items:
          type: string
        description: Street address lines (street number, name, suite, apartment, etc.)
        example: ["123 Main St", "Suite 456"]
      
      locality:
        description: Structured reference to locality (city, district, etc.)
        nullable: true
        oneOf:
          - $ref: "../index.yaml#/components/schemas/cRelation"
          - $ref: "../index.yaml#/components/schemas/Locality"
      
      region:
        description: Structured reference to region/state/province
        nullable: true
        oneOf:
          - $ref: "../index.yaml#/components/schemas/cRelation"
          - $ref: "../index.yaml#/components/schemas/Locality"
      
      country:
        description: Structured reference to country
        nullable: true
        oneOf:
          - $ref: "../index.yaml#/components/schemas/cRelation"
          - $ref: "../index.yaml#/components/schemas/Country"
      
      # Free-text fallbacks for unstructured data
      localityText:
        type: string
        nullable: true
        description: City/locality as free text (when structured locality not available)
        example: "San Francisco"
      
      regionText:
        type: string
        nullable: true
        description: State/region as free text (when structured region not available)
        example: "California"
      
      countryText:
        type: string
        nullable: true
        description: Country as free text (when structured country not available)
        example: "United States"
      
      postalCode:
        type: string
        nullable: true
        description: Postal or ZIP code
        example: "94105"
      
      geoLocation:
        type: object
        nullable: true
        description: Geographic coordinates using GeoJSON Point format [longitude, latitude]
        required:
          - type
          - coordinates
        properties:
          type:
            type: string
            description: The GeoJSON type, must be "Point"
            enum: [Point]
            example: "Point"
          coordinates:
            type: array
            minItems: 2
            maxItems: 2
            items:
              type: number
              format: double
            description: Array containing [longitude, latitude] coordinates
            example: [-122.4194, 37.7749]
      
      recipient:
        type: string
        nullable: true
        description: Name of person or entity to receive mail at this address
        example: "Jane Smith, Purchasing Dept."
      
      phone:
        type: string
        nullable: true
        description: Phone number associated with this address
        example: "+1-415-555-5555"
      
      email:
        type: string
        format: email
        nullable: true
        description: Email address associated with this address
        example: "shipping.sf@example.com"
      
      addressType:
        description: Type of address (taxonomy with sourceType for connection-specific values)
        nullable: true
        oneOf:
          - $ref: "../index.yaml#/components/schemas/cRelation"
          - $ref: "../index.yaml#/components/schemas/iTaxonomy"
      
      isActive:
        type: boolean
        description: Flag indicating if the address is currently valid and usable
        default: true
      
      isPrimary:
        type: boolean
        description: Flag indicating if this is the primary address
        default: false
      
      validFrom:
        type: string
        format: date-time
        nullable: true
        description: Date from which this address is valid
      
      validTo:
        type: string
        format: date-time
        nullable: true
        description: Date until which this address is valid
